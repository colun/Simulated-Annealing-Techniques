
# 探索空間が連結

探索空間のグラフが連結になるとは限りません。
近傍が不適切だと例えば、すべての状態数が1e20コであるとき、状態数が1e10コのグラフが1e10コ、といったことが起こりえます。
たとえ、1つのグラフの最適解が求まっても、すべてのグラフの最適解には大きく劣ってしまいます。
しかも、細切れになっていても1つ1つのグラフは巨大でそれっぽく焼きなまされるため気づきにくいです。

## 近傍の外径が足りないケース

![outside-diameter](/images/outside-diameter.png)

近傍の大きさといったら外径を指すようです。

## 近傍の内径が足りないケース

![inside-diameter](/images/inside-diameter.png)

内径が大きいほうが良いばあいは存在しません。
内径は最小がベストです。

## 近傍の種類が足りないケース

例はありません。

## 連結かどうかを調べる

実際に知るのは存外に難しいです。
それでもまずは**連結かどうかを意識するのが大切**です。
無自覚な損失は本当に気づかないので。
例えば、安直な近傍だと連結にならないコンテストで、工夫して連結にできていたのはそれぞれおそらく、[4/124人中](https://community.topcoder.com/longcontest/stats/?&sr=1&nr=50&module=ViewOverview&rd=16702), [6/70人中](https://community.topcoder.com/longcontest/?module=ViewStandings&rd=16997), [4/136人中](https://hokudai-hitachi2017-2.contest.atcoder.jp/standings#page_1) だけです。

調べ方は、近傍をつたって到達できない2状態を反例としてあげるくらいしかないと思います。
状態（極端なものやコーナーケースを含むとなお良い）を思い浮かべて、それに近い状態に近傍をつたって到達できるかをいくつか試しましょう。

他に、ある seed を複数回、長時間、焼きなまして特にスコアが悪かった状態の visualization を眺めると、ここをこうすればスコアが良くなるが今の近傍だと到達できないという反例が見つかるかもです。

反例が見つかれば、2状態をつたう近傍を考えればよくこれは簡単です。
